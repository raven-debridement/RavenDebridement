#!/usr/bin/env python

# Import required Python code.
import roslib
roslib.load_manifest('master-control')
import rospy

import tf
import tf.transformations as tft
import tfx

from geometry_msgs.msg import PointStamped, Point, PoseStamped, Quaternion
from raven_pose_estimator.srv import ThreshRed

from scripts import Util
from scripts import Constants
from scripts.GripperControl import GripperControlClass
from scripts.ImageDetection import ImageDetectionClass
from scripts.ARImageDetection import ARImageDetectionClass

import numpy as np
import pylab

import code

class TapeErrorTest():
    def __init__(self):
        self.imageDetector = ARImageDetectionClass()

        self.estimatedPose = None
        self.tapePose = None
        
        self.tapePoseReceived = False

        self.wristFrame = '/stereo_33'

        rospy.Subscriber(Constants.GripperTape.Topic, PoseStamped, self.tapeCallback)
        #rospy.Subscriber('estimated_pose', PoseStamped, self.estimateCallback)

        rospy.sleep(2)

    def tapeCallback(self, msg):
        self.tapePose = tfx.pose(msg)

        tf_tapeframe_to_link0 = tfx.lookupTransform(Constants.Frames.Link0, self.tapePose.frame, wait=5)
        self.tapePose = tf_tapeframe_to_link0 * self.tapePose

        self.tapePoseReceived = True

    def estimateCallback(self, msg):
        if self.estimatedPose == None:
            self.estimatedPose = tfx.pose(msg)

    def runTest(self):
        while self.tapePose == None and not rospy.is_shutdown():
            if self.estimatedPose == None:
                rospy.loginfo('Waiting for estimatedPose')
            if self.tapePose == None:
                rospy.loginfo('Waiting for tapePose')
            rospy.sleep(.5)
        
        tapePose = self.tapePose

        self.origEstimatedPose = tfx.pose(self.tapePose)
        tf_tape_to_wrist = tfx.lookupTransform(self.wristFrame, self.origEstimatedPose.frame, wait=5)
        self.origEstimatedPose = tf_tape_to_wrist * self.origEstimatedPose

        estimatedPoseList = []
        tapePoseList = []
        deltaPoseList = []
        deltaTransNormList = []
        deltaRotNormList = []

        iterations = 0
        response = ''

        while not rospy.is_shutdown():
            rospy.loginfo('Top of loop')
            if iterations >= 5:
                iterations = 0
                rospy.loginfo('Press enter to continue or type "exit" then press enter to exit')
                response = raw_input()
            
            if response == 'exit':
                break
            
            rospy.sleep(.5)
            if self.tapePoseReceived:
                rospy.loginfo('New tapePose')
                #rospy.loginfo('Press enter')
                #raw_input()
                iterations += 1

                tapePose = self.tapePose

                self.tapePoseReceived = False

                estimatedPose = tfx.pose(self.origEstimatedPose, stamp=rospy.Time.now())
                tf_estimated_to_wrist = tfx.lookupTransform(self.wristFrame, estimatedPose.frame, wait=5)
                estimatedPose = tf_estimated_to_wrist * estimatedPose


                estimatedPoseList.append(estimatedPose.matrix)
                tapePoseList.append(tapePose.matrix)

                deltaPose = tfx.pose(Util.deltaPose(tapePose, estimatedPose, Constants.Frames.Link0, Constants.Frames.LeftTool))
                deltaPoseList.append(deltaPose.matrix)

                deltaTransNormList.append(deltaPose.position.norm_2)

                deltaRotNormList.append(Util.angleBetweenQuaternions(deltaPose.orientation.msg.Quaternion(), tfx.quaternion([0,0,0,1]).msg.Quaternion()))

                print('estimatedPose')
                print(estimatedPoseList[-1])
                print('tapePose')
                print(tapePoseList[-1])
                print('deltaPose')
                print(deltaPoseList[-1])
                print('deltaTransNorm')
                print(deltaTransNormList[-1])
                print('deltaRotNorm')
                print(deltaRotNormList[-1])

                #code.interact(local=locals())



        return estimatedPoseList, tapePoseList, deltaPoseList, deltaTransNormList, deltaRotNormList
                

def pose_error(pose_hat, pose):
    pose_hat = tfx.pose(pose_hat)
    pose = tfx.pose(pose)

    X_hat = pose_hat.matrix
    X = pose.matrix

    R_hat = np.array(pose_hat.rotation.matrix)
    R = np.array(pose.rotation.matrix)

    p_hat = np.array(pose_hat.position.vector3)
    p = np.array(pose.position.vector3)

    X_bar = np.hstack((np.dot(R_hat.T,R), np.dot(R_hat.T, p-p_hat)))
    X_bar = np.vstack((X_bar, np.array([0,0,0,1])))

    code.interact(local=locals())

    return X_bar
    

def test_tape_error():
    rospy.init_node('test_tape_error',anonymous=True)
    tapeErrorTest = TapeErrorTest()
    estimatedPoseList, tapePoseList, deltaPoseList, deltaTransNormList, deltaRotNormList = tapeErrorTest.runTest()

    for index in range(len(estimatedPoseList)):
        print('Iteration ' + str(index))
        print('estimatedPose')
        print(estimatedPoseList[index])
        print('tapePose')
        print(tapePoseList[index])
        print('deltaPose')
        print(deltaPoseList[index])
        print('deltaTransNorm')
        print(deltaTransNormList[index])
        print('deltaRotNorm')
        print(deltaRotNormList[index])

    fig, graphs = pylab.subplots(2, sharex=True, sharey=False)
    
    x = np.array(range(len(deltaTransNormList)))
    graphs[0].plot(x, np.array(deltaTransNormList))
    graphs[0].set_title('delta translation norm')
    graphs[1].plot(x, np.array(deltaRotNormList))
    graphs[1].set_title('delta rotation norm')

    pylab.show()

def test_pose_error():
    estimatedPoseMatrix = np.array(
        [[  1.14865522e-01,   9.91918767e-01,  -5.38801529e-02,   8.19362143e-04],
         [  9.66254755e-01,  -9.89757417e-02,   2.37814111e-01,   2.63457680e-02],
         [  2.30559451e-01,  -7.93785957e-02,  -9.69815126e-01,   3.25400622e-03],
         [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   1.00000000e+00]])

    tapePoseMatrix = np.array(
        [[-0.06660568,  0.99063038,  0.1192272,  -0.00285434],
         [-0.14934233,  0.10824874, -0.98284235, -0.02663261],
         [-0.98653969, -0.08326855,  0.14073307, -0.09168835],
         [ 0.        ,  0.        ,  0.        ,  1.        ]])

    estimatedPose = tfx.pose(estimatedPoseMatrix)
    tapePose = tfx.pose(tapePoseMatrix)

    poseErrorMatrix = pose_error(estimatedPose, tapePose)
    
    print(poseErrorMatrix)
    

    code.interact(local=locals())

if __name__ == '__main__':
    test_tape_error()
    #test_pose_error()

"""
Below are records of the test:

Moves to a new spot after 5 iterations

Iteration 0
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.06660568  0.99063038  0.1192272  -0.00285434]
 [-0.14934233  0.10824874 -0.98284235 -0.02663261]
 [-0.98653969 -0.08326855  0.14073307 -0.09168835]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99996158e-01   8.88796849e-04  -2.62577226e-03  -3.64838328e-06]
 [ -8.94041507e-04   9.99997607e-01  -1.99687928e-03   1.54861199e-05]
 [  2.62399116e-03   1.99921915e-03   9.99994559e-01  -1.17073222e-06]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
1.59530945007e-05
deltaRotNorm
0.195787972161

Iteration 1
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.06681162  0.99052094  0.12001868 -0.00285434]
 [-0.14835243  0.10908868 -0.98289939 -0.02663261]
 [-0.98667511 -0.08347416  0.13965779 -0.09168835]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99996886e-01   1.32725080e-03  -2.11361452e-03  -1.77884865e-05]
 [ -1.33361728e-03   9.99994570e-01  -3.01357388e-03   2.34682448e-05]
 [  2.10960328e-03   3.01638325e-03   9.99993225e-01  -8.68451253e-07]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
2.94608718527e-05
deltaRotNorm
0.224253667034

Iteration 2
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.06926967  0.99143718  0.11069792 -0.0028744 ]
 [-0.16042449  0.09844977 -0.98212608 -0.02638275]
 [-0.98461449 -0.0857902   0.15223122 -0.09158311]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99961093e-01  -3.73267700e-03   7.99246775e-03  -1.35884445e-05]
 [  3.66670349e-03   9.99959219e-01   8.25326393e-03  -1.58287976e-04]
 [ -8.02294857e-03  -8.22363681e-03   9.99934000e-01  -9.79288480e-05]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.00018662740524
deltaRotNorm
0.691572726905

Iteration 3
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.06892811  0.99117911  0.11319402 -0.00285434]
 [-0.15722344  0.10125316 -0.98235869 -0.02663261]
 [-0.98515466 -0.08550888  0.14885741 -0.09168835]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99976705e-01  -1.83768349e-03   6.57367616e-03  -2.56077997e-05]
 [  1.80827891e-03   9.99988347e-01   4.47623066e-03   6.84472944e-05]
 [ -6.58182545e-03  -4.46423934e-03   9.99968375e-01   1.83839534e-05]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
7.535755605e-05
deltaRotNorm
0.467494745634

Iteration 4
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.07102482  0.99190612  0.10525079 -0.0028744 ]
 [-0.16749219  0.09215941 -0.98155642 -0.02638275]
 [-0.98331167 -0.08734356  0.15959092 -0.09158311]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99864118e-01  -5.36088787e-03   1.55886487e-02   1.52680883e-05]
 [  5.16195869e-03   9.99905091e-01   1.27735125e-02  -2.50009176e-04]
 [ -1.56556466e-02  -1.26913088e-02   9.99796895e-01  -1.07755279e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000272669952169
deltaRotNorm
1.1935016312

Iteration 5
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.39193199  0.8915993  -0.22680387 -0.04506193]
 [-0.14828764 -0.30452712 -0.94089001 -0.02599345]
 [-0.90796481 -0.33513268  0.25156708 -0.07981787]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99287954e-01   3.82385819e-03  -3.75361548e-02   3.13898447e-04]
 [ -5.68782373e-03   9.98749120e-01  -4.96774042e-02   7.33719784e-04]
 [  3.72992422e-02   4.98555306e-02   9.98059714e-01  -4.42429331e-05]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000799271163862
deltaRotNorm
3.58017595426

Iteration 6
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.39462976  0.89011061 -0.22797028 -0.04506193]
 [-0.1435343  -0.30477926 -0.94154528 -0.02599345]
 [-0.90756006 -0.33884023  0.24803637 -0.07981787]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99071996e-01  -6.53214960e-04  -4.30664601e-02   3.07697427e-04]
 [ -1.57986240e-03   9.98656361e-01  -5.17974672e-02   6.90194408e-04]
 [  4.30424292e-02   5.18174380e-02   9.97728572e-01  -8.51397054e-05]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000760456965642
deltaRotNorm
3.8625995105

Iteration 7
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.39678052  0.88891222 -0.22891108 -0.04506193]
 [-0.13972918 -0.30496715 -0.94205668 -0.02599345]
 [-0.90721606 -0.34180419  0.245212   -0.07981787]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99033368e-01  -2.87848976e-03  -4.38639174e-02   3.03502853e-04]
 [  5.56910618e-04   9.98602444e-01  -5.28474144e-02   6.98213214e-04]
 [  4.39547358e-02   5.27719021e-02   9.97638766e-01  -5.95026824e-05]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000763646673853
deltaRotNorm
3.93938541098

Iteration 8
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.39539591  0.89252595 -0.21693204 -0.04507656]
 [-0.15077086 -0.29604141 -0.94320074 -0.02577041]
 [-0.906052   -0.34023069  0.25162046 -0.07968946]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99373743e-01   1.25801246e-03  -3.53629625e-02   3.14505187e-04]
 [ -3.44903656e-03   9.98072323e-01  -6.19656557e-02   4.81379579e-04]
 [  3.52168406e-02   6.20488174e-02   9.97451612e-01  -1.79789825e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000602465097001
deltaRotNorm
4.09353905333

Iteration 9
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.39934722  0.89097118 -0.21608366 -0.04508668]
 [-0.16235052 -0.30069413 -0.9398007  -0.02574332]
 [-0.90231043 -0.3402255   0.264731   -0.07972205]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99740597e-01   7.79262704e-04  -2.27624917e-02   3.36776006e-04]
 [ -2.08697323e-03   9.98344296e-01  -5.74831352e-02   4.52442348e-04]
 [  2.26800093e-02   5.75157286e-02   9.98086949e-01  -1.90874306e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000595445344093
deltaRotNorm
3.54557620123

Iteration 10
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.37627296  0.89417409 -0.24263418 -0.04060196]
 [ 0.26365967 -0.14771214 -0.95323906  0.00756984]
 [-0.88820169 -0.42265093 -0.18017756 -0.08345661]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.94011250e-01  -1.01970188e-02  -1.08800991e-01   2.02325619e-04]
 [  7.95829831e-03   9.99747996e-01  -2.09907190e-02   5.85803323e-04]
 [  1.08987615e-01   1.99991401e-02   9.93841906e-01   1.77043025e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.00064455055862
deltaRotNorm
6.38319222037

Iteration 11
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.37584234  0.89531016 -0.23908629 -0.04057586]
 [ 0.27362012 -0.13928175 -0.95169986  0.00738283]
 [-0.88536691 -0.42310793 -0.19262689 -0.08358088]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.93142473e-01  -1.17734243e-02  -1.16316009e-01   1.82244770e-04]
 [  8.78422910e-03   9.99618697e-01  -2.61782024e-02   7.32144039e-04]
 [  1.16579864e-01   2.49769382e-02   9.92867206e-01   2.90552380e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000808497826475
deltaRotNorm
6.87283573636

Iteration 12
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.37552555  0.89619865 -0.23623832 -0.04057586]
 [ 0.2815631  -0.13253092 -0.95034613  0.00738283]
 [-0.8830078  -0.42339525 -0.20256773 -0.08358088]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.92180329e-01  -1.37101977e-02  -1.24057348e-01   1.61518998e-04]
 [  9.40497153e-03   9.99335227e-01  -3.52228699e-02   6.94101004e-04]
 [  1.24457790e-01   3.37806828e-02   9.91649698e-01   3.01409356e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.00077376494498
deltaRotNorm
7.43928201036

Iteration 13
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.37537535  0.89549547 -0.23912591 -0.04060196]
 [ 0.27624131 -0.13817961 -0.95110311  0.00756984]
 [-0.88475086 -0.42307712 -0.19550362 -0.08345661]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.92522593e-01  -1.24515632e-02  -1.21424300e-01   2.10599726e-04]
 [  8.76261237e-03   9.99485075e-01  -3.08674690e-02   5.26002871e-04]
 [  1.21746124e-01   2.95726663e-02   9.92120627e-01   1.64981101e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000590127129155
deltaRotNorm
7.22307363893

Iteration 14
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.37515514  0.89634609 -0.23626743 -0.04057586]
 [ 0.28365542 -0.1316489  -0.94984639  0.00738283]
 [-0.88249545 -0.4233583  -0.20486466 -0.08358088]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.91620639e-01  -1.46745632e-02  -1.28347831e-01   1.79608186e-04]
 [  9.79989894e-03   9.99209407e-01  -3.85295141e-02   7.11969802e-04]
 [  1.28811764e-01   3.69488656e-02   9.90980480e-01   2.95194445e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.00079139109155
deltaRotNorm
7.73325646062

Iteration 15
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[ 0.16312584  0.89598085  0.41304754  0.03053161]
 [-0.08983584  0.43040529 -0.89815411 -0.0248735 ]
 [-0.98250673  0.10940567  0.15070142 -0.08983972]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99379246e-01  -1.41987431e-02  -3.22415716e-02  -5.77945768e-04]
 [  1.58869642e-02   9.98482745e-01   5.27239281e-02   5.50466555e-04]
 [  3.14440394e-02  -5.32034202e-02   9.98088507e-01   2.39607327e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000833334512883
deltaRotNorm
3.6466724183

Iteration 16
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[ 0.1599984   0.88679606  0.4335819   0.03043693]
 [-0.06611508  0.44788144 -0.89164512 -0.02463407]
 [-0.98490066  0.11399549  0.1302909  -0.0897339 ]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.98441080e-01  -5.46248084e-03  -5.55479101e-02  -4.93780768e-04]
 [  7.39331903e-03   9.99373409e-01   3.46139996e-02   3.70374275e-04]
 [  5.53240259e-02  -3.49707226e-02   9.97855852e-01   1.14062579e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000627699627233
deltaRotNorm
3.77075116685

Iteration 17
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[ 0.16008666  0.88755291  0.43199779  0.03049104]
 [-0.06570955  0.44625327 -0.89249105 -0.024891  ]
 [-0.98491346  0.11448953  0.1297599  -0.08980218]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.98495935e-01  -5.85402179e-03  -5.45123693e-02  -5.47704128e-04]
 [  7.82177207e-03   9.99322827e-01   3.59542254e-02   6.40486868e-04]
 [  5.42649782e-02  -3.63265312e-02   9.97865570e-01   1.75865570e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000860890201125
deltaRotNorm
3.76465137537

Iteration 18
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[ 0.16022768  0.8900801   0.4267136   0.03049104]
 [-0.07270276  0.44176641 -0.89417937 -0.0248735 ]
 [-0.984399    0.11224903  0.13549448 -0.08983972]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.98770305e-01  -8.26029565e-03  -4.88839988e-02  -5.57519452e-04]
 [  1.02976481e-02   9.99082389e-01   4.15733018e-02   6.24767129e-04]
 [  4.84957346e-02  -4.20255695e-02   9.97938884e-01   2.29020692e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000868108507916
deltaRotNorm
3.7175644529

Iteration 19
estimatedPose
[[  1.14865522e-01   9.91918767e-01  -5.38801529e-02   8.19362143e-04]
 [  9.66254755e-01  -9.89757417e-02   2.37814111e-01   2.63457680e-02]
 [  2.30559451e-01  -7.93785957e-02  -9.69815126e-01   3.25400622e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[ 0.16031091  0.89208385  0.422477    0.03049104]
 [-0.07829548  0.43815649 -0.89548239 -0.0248735 ]
 [-0.98395642  0.11047756  0.1400874  -0.08983972]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99004149e-01  -1.15094171e-02  -4.31073557e-02  -5.48375022e-04]
 [  1.34182260e-02   9.98930105e-01   4.42560240e-02   5.93881519e-04]
 [  4.25518743e-02  -4.47903758e-02   9.98089756e-01   2.29432886e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000840267738136
deltaRotNorm
3.61341015445

"""


"""
Tape error test for wide baseline

Iteration 1
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.11030375 -0.9826824  -0.14889049 -0.05678665]
 [ 0.06461205 -0.15657752  0.98554998  0.01385556]
 [-0.99179553  0.09908974  0.08076421 -0.14919   ]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99521308e-01  -9.94194764e-03   2.92969687e-02   5.08647555e-06]
 [  1.03196476e-02   9.99865217e-01  -1.27692416e-02   1.14111121e-05]
 [ -2.91660688e-02   1.30654635e-02   9.99489187e-01   3.01683551e-05]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
3.26529533084e-05
deltaRotNorm
1.92124129406
Iteration 2
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.10879565 -0.98266882 -0.15008496 -0.05678665]
 [ 0.06777346 -0.15796232  0.98511657  0.01389076]
 [-0.99175111  0.09700462  0.08378448 -0.14924217]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99374330e-01  -1.27774651e-02   3.29800588e-02   6.18201009e-05]
 [  1.33346337e-02   9.99771124e-01  -1.67298046e-02   3.57871428e-06]
 [ -3.27587460e-02   1.71591143e-02   9.99315981e-01   7.36629687e-05]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
9.62328687807e-05
deltaRotNorm
2.247544695
Iteration 3
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.11296813 -0.98328921 -0.14276042 -0.05678665]
 [ 0.05875181 -0.15003931  0.98693284  0.0139258 ]
 [-0.99186008  0.10310452  0.07471968 -0.14929413]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99702017e-01  -6.14459802e-03   2.36245795e-02   1.47824107e-05]
 [  6.22182255e-03   9.99975535e-01  -3.19670704e-03  -5.97828812e-05]
 [ -2.36043590e-02   3.34274241e-03   9.99715790e-01   1.00375198e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000117761169183
deltaRotNorm
1.41125568054
Iteration 4
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.11430996 -0.98344149 -0.14062742 -0.05678665]
 [ 0.05147293 -0.14722821  0.98776232  0.01385556]
 [-0.99211076  0.10567257  0.06745027 -0.14919   ]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99852206e-01  -4.82498529e-03   1.65010911e-02   3.10809042e-05]
 [  4.88096471e-03   9.99982464e-01  -3.35387855e-03   6.55762063e-05]
 [ -1.64846193e-02   3.43392411e-03   9.99858223e-01   2.96051346e-05]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
7.83755410167e-05
deltaRotNorm
1.00409222103
Iteration 5
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.19158841 -0.74860021 -0.63473744 -0.00837281]
 [ 0.83180135 -0.46711915  0.29984366  0.02273215]
 [-0.52096104 -0.47052888  0.71218128 -0.1536307 ]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  5.91905257e-01  -1.10019532e-01   7.98463443e-01   3.04557831e-05]
 [  3.75513695e-01   9.14200548e-01  -1.52403488e-01  -1.55866867e-04]
 [ -7.13188356e-01   3.90042383e-01   5.82433951e-01  -3.24305791e-05]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000162091879281
deltaRotNorm
57.0252162366
Iteration 6
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.07574925 -0.83692476 -0.54205073 -0.00837281]
 [ 0.61163699 -0.46832986  0.63762633  0.02269807]
 [-0.7875038  -0.28323856  0.54736978 -0.15358017]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  8.41056581e-01  -1.00412200e-01   5.31546063e-01  -1.17279260e-05]
 [  1.82362943e-01   9.77731459e-01  -1.03850617e-01  -8.45489808e-05]
 [ -5.09281439e-01   1.84278549e-01   8.40638943e-01  -7.92369273e-05]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000116467012696
deltaRotNorm
33.9306820905
Iteration 7
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.04532603 -0.88285807 -0.46744752 -0.00837561]
 [ 0.46968213 -0.43181721  0.77002116  0.0225482 ]
 [-0.88167128 -0.18464975  0.43423522 -0.15378442]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.21036340e-01  -6.24306685e-02   3.84440466e-01  -1.46497590e-05]
 [  8.83753084e-02   9.94822719e-01  -5.01753196e-02   3.54658992e-04]
 [ -3.79317631e-01   8.01883374e-02   9.21785206e-01   2.71508125e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000446894034185
deltaRotNorm
23.245511324
Iteration 8
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.02517927 -0.89166001 -0.45200491 -0.00837281]
 [ 0.39112281 -0.42489242  0.81638801  0.02273215]
 [-0.919994   -0.15623338  0.35944705 -0.1536307 ]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.51298294e-01  -5.02622682e-02   3.04146775e-01  -9.32078376e-05]
 [  6.38445136e-02   9.97350415e-01  -3.48715939e-02  -2.49299518e-04]
 [ -3.01588187e-01   5.25913907e-02   9.51986718e-01  -8.10577568e-05]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000278223490369
deltaRotNorm
18.136483558
Iteration 9
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.01312711 -0.89734547 -0.44113353 -0.00837281]
 [ 0.33894548 -0.41904552  0.84232821  0.02273215]
 [-0.94071443 -0.13846288  0.30965204 -0.1536307 ]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.67494947e-01  -3.74157066e-02   2.50107161e-01  -1.21227483e-04]
 [  4.57503078e-02   9.98571779e-01  -2.75918647e-02  -3.26063170e-04]
 [ -2.48717584e-01   3.81374693e-02   9.67824931e-01  -1.05007141e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000363372801551
deltaRotNorm
14.7725120766
Iteration 10
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[  7.87663676e-02  -9.85854764e-01  -1.47939999e-01  -1.42786075e-02]
 [ -7.29867095e-01  -1.58113326e-01   6.65052028e-01   1.60397217e-04]
 [ -6.79035996e-01   5.55928046e-02  -7.31996965e-01  -1.49163713e-01]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaPose
[[  7.49413787e-01   2.01992454e-01  -6.30537885e-01   5.25836670e-04]
 [ -7.47754594e-02   9.72055304e-01   2.22524419e-01  -1.42917577e-02]
 [  6.57865949e-01  -1.19614108e-01   7.43575725e-01   4.07759789e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.0148713700432
deltaRotNorm
42.901724668
Iteration 11
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[  8.24351699e-02  -9.77160235e-01  -1.95863009e-01  -1.42678607e-02]
 [ -5.98500852e-01  -2.05685690e-01   7.74267478e-01   2.94717112e-04]
 [ -7.96869609e-01   5.33973063e-02  -6.01786968e-01  -1.48897825e-01]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaPose
[[  8.51632672e-01   1.51153471e-01  -5.01870921e-01   7.19026432e-04]
 [ -7.15057255e-02   9.82068026e-01   1.74440031e-01  -7.16218157e-03]
 [  5.19238600e-01  -1.12672185e-01   8.47169555e-01   2.74618510e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.00770424405317
deltaRotNorm
32.81390358
Iteration 12
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[  4.25927402e-02  -9.60096085e-01  -2.76407969e-01  -1.42094118e-02]
 [ -2.68814846e-01  -2.77469526e-01   9.22360689e-01   1.29182280e-04]
 [ -9.62249675e-01   3.50166963e-02  -2.69906269e-01  -1.49105894e-01]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaPose
[[  9.78620193e-01   7.87028269e-02  -1.90022061e-01  -5.03312461e-05]
 [ -5.79289183e-02   9.91960378e-01   1.12511551e-01  -4.49859779e-04]
 [  1.97349333e-01  -9.90983030e-02   9.75311626e-01  -1.02222361e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000464065153357
deltaRotNorm
13.3578509204
Iteration 13
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[ -1.61161765e-01  -9.83350989e-01   8.39506835e-02  -1.42721001e-02]
 [ -9.58731545e-01   1.76177528e-01   2.23148614e-01   3.62792437e-04]
 [ -2.34223634e-01  -4.45231439e-02  -9.71162694e-01  -1.49000542e-01]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaPose
[[  2.50485379e-01   5.22341611e-01  -8.15117363e-01   4.86850201e-05]
 [  4.49848660e-03   8.41321616e-01   5.40516144e-01  -7.75647972e-04]
 [  9.68109931e-01  -1.39058186e-01   2.08389017e-01  -2.92251922e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000830307890658
deltaRotNorm
81.3673937856
Iteration 14
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[ -1.71035472e-01  -9.80638860e-01   9.53640019e-02  -1.43414952e-02]
 [ -9.60493769e-01   1.87519809e-01   2.05640563e-01   5.55319331e-04]
 [ -2.19541767e-01  -5.64246988e-02  -9.73970054e-01  -1.48847222e-01]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaPose
[[  2.35558445e-01   5.29623661e-01  -8.14868699e-01  -5.39291676e-06]
 [  1.57795199e-02   8.36268102e-01   5.48093667e-01  -1.08306536e-03]
 [  9.71732075e-01  -1.41966329e-01   1.88632807e-01  -4.30649465e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.00116555507328
deltaRotNorm
82.5171353008
Iteration 15
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.19675637 -0.98038452 -0.01153829 -0.07600295]
 [-0.12041729  0.01248434  0.99264486 -0.01141715]
 [-0.9730296   0.19669861 -0.12051162 -0.13774554]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99968816e-01   7.86803953e-03  -6.78587683e-04  -2.90262718e-05]
 [ -7.85088099e-03   9.99718622e-01   2.23839422e-02   6.83594998e-05]
 [  8.54514484e-04  -2.23779166e-02   9.99749218e-01   5.78262604e-05]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
9.41245029474e-05
deltaRotNorm
1.35993980298
Iteration 16
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.20145733 -0.97945201 -0.00941789 -0.07602433]
 [-0.13016468  0.01724053  0.99134248 -0.01162357]
 [-0.97081002  0.20093909 -0.13096329 -0.13790259]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99828226e-01   1.45756778e-02  -1.14485209e-02  -2.01383359e-05]
 [ -1.42279772e-02   9.99452027e-01   2.98866116e-02   2.39444899e-04]
 [  1.18778650e-02  -2.97185885e-02   9.99487730e-01   2.56297155e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000351322705933
deltaRotNorm
2.01119094204
Iteration 17
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.20019225 -0.97974865 -0.00395445 -0.07602433]
 [-0.12838179  0.02223049  0.99147563 -0.0115875 ]
 [-0.971309    0.19899342 -0.13023226 -0.13795607]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99869348e-01   1.33512175e-02  -9.11220045e-03  -8.60605773e-06]
 [ -1.30318089e-02   9.99328148e-01   3.42552946e-02   1.40466547e-04]
 [  9.56342828e-03  -3.41320706e-02   9.99371574e-01   2.87624086e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.00032020701048
deltaRotNorm
2.167493568
Iteration 18
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.19040837 -0.98157072 -0.01623517 -0.07609336]
 [-0.09719663  0.00239289  0.99526232 -0.01158495]
 [-0.9768815   0.19108428 -0.095861   -0.13795026]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99712853e-01   9.57281111e-05   2.39625114e-02   9.40984347e-05]
 [ -4.16727646e-04   9.99910246e-01   1.33912702e-02   1.54556872e-04]
 [ -2.39590788e-02  -1.33974108e-02   9.99623165e-01   2.26164492e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000289642399718
deltaRotNorm
1.57306195385
Iteration 19
estimatedPose
[[  1.45370354e-01  -9.84158868e-01   1.01482914e-01   1.68550741e-04]
 [  9.43754198e-01   1.07146744e-01  -3.12805992e-01   3.35089398e-02]
 [  2.96977227e-01   1.41247644e-01   9.44380024e-01   6.63776991e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
tapePose
[[-0.18543648 -0.98244101 -0.02056629 -0.07602831]
 [-0.08617336 -0.00459049  0.99626958 -0.01158495]
 [-0.9788705   0.18651699 -0.083809   -0.13795026]
 [ 0.          0.          0.          1.        ]]
deltaPose
[[  9.99453376e-01  -4.09638589e-03   3.28050086e-02   1.25082080e-04]
 [  3.82401012e-03   9.99957732e-01   8.36131210e-03   7.24335938e-05]
 [ -3.28378731e-02  -8.23129492e-03   9.99426796e-01   1.59122320e-04]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00]]
deltaTransNorm
0.000214969916166
deltaRotNorm
1.95328108586


"""
